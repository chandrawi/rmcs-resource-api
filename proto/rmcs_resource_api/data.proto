syntax = "proto3";
package data;

service DataService {
    rpc ReadData(DataId) returns (DataReadResponse);

    rpc ListDataByTime(DataTime) returns (DataListResponse);

    rpc ListDataByLatest(DataTime) returns (DataListResponse);

    rpc ListDataByRange(DataRange) returns (DataListResponse);

    rpc ListDataByNumberBefore(DataNumber) returns (DataListResponse);

    rpc ListDataByNumberAfter(DataNumber) returns (DataListResponse);

    rpc ListDataGroupByTime(DataGroupTime) returns (DataListResponse);

    rpc ListDataGroupByLatest(DataGroupTime) returns (DataListResponse);

    rpc ListDataGroupByRange(DataGroupRange) returns (DataListResponse);

    rpc ListDataGroupByNumberBefore(DataGroupNumber) returns (DataListResponse);

    rpc ListDataGroupByNumberAfter(DataGroupNumber) returns (DataListResponse);

    rpc ReadDataSet(DataSetId) returns (DataSetReadResponse);

    rpc ListDataSetByTime(DataSetTime) returns (DataSetListResponse);

    rpc ListDataSetByLatest(DataSetTime) returns (DataSetListResponse);

    rpc ListDataSetByRange(DataSetRange) returns (DataSetListResponse);

    rpc CreateData(DataSchema) returns (DataChangeResponse);

    rpc CreateDataMultiple(DataMultipleSchema) returns (DataChangeResponse);

    rpc DeleteData(DataId) returns (DataChangeResponse);

    rpc ReadDataTimestamp(DataId) returns (TimestampReadResponse);

    rpc ListDataTimestampByLatest(DataTime) returns (TimestampListResponse);

    rpc ListDataTimestampByRange(DataRange) returns (TimestampListResponse);

    rpc ReadDataGroupTimestamp(DataGroupId) returns (TimestampReadResponse);

    rpc ListDataGroupTimestampByLatest(DataGroupTime) returns (TimestampListResponse);

    rpc ListDataGroupTimestampByRange(DataGroupRange) returns (TimestampListResponse);

    rpc CountData(DataTime) returns (DataCountResponse);

    rpc CountDataByLatest(DataTime) returns (DataCountResponse);

    rpc CountDataByRange(DataRange) returns (DataCountResponse);

    rpc CountDataGroup(DataGroupTime) returns (DataCountResponse);

    rpc CountDataGroupByLatest(DataGroupTime) returns (DataCountResponse);

    rpc CountDataGroupByRange(DataGroupRange) returns (DataCountResponse);
}

message DataSchema {
    bytes device_id = 1;
    bytes model_id = 2;
    int64 timestamp = 3;
    bytes data_bytes = 4;
    repeated uint32 data_type = 5;
    int32 tag = 6;
}

message DataMultipleSchema {
    repeated DataSchema schemas = 1;
}

message DataId {
    bytes device_id = 1;
    bytes model_id = 2;
    int64 timestamp = 3;
    optional int32 tag = 4;
}

message DataTime {
    bytes device_id = 1;
    bytes model_id = 2;
    int64 timestamp = 3;
    optional int32 tag = 4;
}

message DataRange {
    bytes device_id = 1;
    bytes model_id = 2;
    int64 begin = 3;
    int64 end = 4;
    optional int32 tag = 5;
}

message DataNumber {
    bytes device_id = 1;
    bytes model_id = 2;
    int64 timestamp = 3;
    uint32 number = 4;
    optional int32 tag = 5;
}

message DataSetSchema {
    bytes set_id = 1;
    int64 timestamp = 2;
    bytes data_bytes = 3;
    repeated uint32 data_type = 4;
    int32 tag = 5;
}

message DataGroupId {
    repeated bytes device_ids = 1;
    repeated bytes model_ids = 2;
    int64 timestamp = 3;
    optional int32 tag = 4;
}

message DataGroupTime {
    repeated bytes device_ids = 1;
    repeated bytes model_ids = 2;
    int64 timestamp = 3;
    optional int32 tag = 4;
}

message DataGroupRange {
    repeated bytes device_ids = 1;
    repeated bytes model_ids = 2;
    int64 begin = 3;
    int64 end = 4;
    optional int32 tag = 5;
}

message DataGroupNumber {
    repeated bytes device_ids = 1;
    repeated bytes model_ids = 2;
    int64 timestamp = 3;
    uint32 number = 4;
    optional int32 tag = 5;
}

message DataSetId {
    bytes set_id = 1;
    int64 timestamp = 2;
    optional int32 tag = 3;
}

message DataSetTime {
    bytes set_id = 1;
    int64 timestamp = 2;
    optional int32 tag = 3;
}

message DataSetRange {
    bytes set_id = 1;
    int64 begin = 2;
    int64 end = 3;
    optional int32 tag = 4;
}

message DataReadResponse {
    DataSchema result = 1;
}

message DataListResponse {
    repeated DataSchema results = 1;
}

message DataSetReadResponse {
    DataSetSchema result = 1;
}

message DataSetListResponse {
    repeated DataSetSchema results = 1;
}

message DataChangeResponse {
}

message TimestampReadResponse {
    int64 timestamp = 1;
}

message TimestampListResponse {
    repeated int64 timestamps = 1;
}

message DataCountResponse {
    uint32 count = 1;
}
