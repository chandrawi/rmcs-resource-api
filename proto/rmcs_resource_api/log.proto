syntax = "proto3";
package log;

service LogService {
    rpc ReadLog(LogId) returns (LogReadResponse);

    rpc ReadLogByTime(LogTime) returns (LogReadResponse);

    rpc ListLog(LogIds) returns (LogListResponse);

    rpc ListLogByTime(LogTime) returns (LogListResponse);

    rpc ListLogByLastTime(LogTime) returns (LogListResponse);

    rpc ListLogByRangeTime(LogRange) returns (LogListResponse);

    rpc CreateLog(LogSchema) returns (LogCreateResponse);

    rpc UpdateLog(LogUpdate) returns (LogChangeResponse);

    rpc UpdateLogByTime(LogUpdateTime) returns (LogChangeResponse);

    rpc DeleteLog(LogId) returns (LogChangeResponse);

    rpc DeleteLogByTime(LogTime) returns (LogChangeResponse);
}

message LogSchema {
    int32 id = 1;
    int64 timestamp = 2;
    optional bytes device_id = 3;
    optional bytes model_id = 4;
    bytes log_bytes = 5;
    uint32 log_type = 6;
    int32 tag = 7;
}

message LogId {
    int32 id = 1;
}

message LogIds {
    repeated int32 ids = 1;
}

message LogTime {
    int64 timestamp = 1;
    optional bytes device_id = 2;
    optional bytes model_id = 3;
    optional int32 tag = 4;
}

message LogRange {
    int64 begin = 1;
    int64 end = 2;
    optional bytes device_id = 3;
    optional bytes model_id = 4;
    optional int32 tag = 5;
}

message LogUpdate {
    int32 id = 1;
    optional bytes log_bytes = 2;
    optional uint32 log_type = 3;
    optional int32 tag = 4;
}

message LogUpdateTime {
    int64 timestamp = 1;
    optional bytes device_id = 2;
    optional bytes model_id = 3;
    optional bytes log_bytes = 4;
    optional uint32 log_type = 5;
    optional int32 tag = 6;
}

message LogReadResponse {
    LogSchema result = 1;
}

message LogListResponse {
    repeated LogSchema results = 1;
}

message LogCreateResponse {
    int32 id = 1;
}

message LogChangeResponse {
}
